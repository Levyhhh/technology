# HTTP工作原理

## 请求/响应模型

- **客户端发起请求**：客户端（如浏览器）通过URL向服务器发送请求，告知服务器需要获取的资源或执行的操作。每个请求都包含请求方法、URL、协议版本、请求头和请求体等信息。
- **服务器响应请求**：服务器接收到客户端的请求后，根据请求的内容进行处理，并返回相应的响应。响应包括状态行、响应头和响应体等部分，状态行指示请求的处理结果，响应头包含关于响应的元信息，响应体则包含请求的资源或处理结果的数据。

## 工作过程

1. **建立连接**：在HTTP工作开始之前，客户端（如Web浏览器）首先要通过网络与服务器建立连接，该连接通常是通过TCP来完成的，一般TCP连接的端口号是80（HTTP）或443（HTTPS）。这涉及到TCP的三次握手过程，以确保连接的可靠性。
2. **发送请求**：连接建立后，客户端将请求信息封装成HTTP请求数据包，包括请求行、请求头部、空行和请求体（GET请求通常没有请求体，POST等请求可能有请求体）。请求行包含请求方法（如GET、POST等）、URL和HTTP协议版本；请求头部用来描述客户端的基本信息和请求的附加条件等；空行用于分隔请求头部与请求体；请求体中存放要提交到服务器的数据。然后客户端将封装好的HTTP请求数据包发送给服务器。
3. **服务器处理请求**：服务器接收到HTTP请求数据包后，首先解析请求，从中获取请求方法、URL、请求头和请求体等信息。然后根据请求的内容，如请求的资源路径、请求方法等，在服务器上执行相应的操作，可能涉及到查询数据库、调用应用程序逻辑、读取文件等，以生成响应数据。
4. **发送响应**：服务器将处理结果封装成HTTP响应数据包，包括状态行、响应头部、空行和响应体。状态行包含HTTP协议版本、状态码和状态描述；响应头部包含关于响应的元信息，如Content-Type（指定响应数据的类型）、Content-Length（指定响应数据的长度）等；空行用于分隔响应头部与响应体；响应体中存放服务器响应给客户端的资源内容或处理结果数据。最后服务器将响应数据包发送给客户端。
5. **关闭连接**：客户端收到响应后，会根据响应内容进行处理，如渲染网页、播放视频、显示图片等。如果是HTTP/1.0及之前版本，或者HTTP/1.1中没有设置持久连接（keep-alive），则连接会被关闭；如果是HTTP/1.1及之后版本且设置了持久连接，连接可以保持打开状态，以便客户端可以通过同一个连接发送多个请求，节省了为每个请求建立新连接所需的时间和网络带宽。

## 常见的HTTP请求方法

- **GET**：用于从服务器获取资源，请求的参数通常通过URL的查询字符串传递，数据会显示在URL中，有长度限制，且不安全，一般用于获取数据。
- **POST**：用于向服务器提交数据，通常用于创建新资源或更新现有资源，参数放在请求体中，相对安全，没有长度限制。
- **PUT**：用于更新服务器上的资源，通过请求体传递更新的数据。
- **DELETE**：用于删除服务器上的资源。

## 状态码

- **1xx（信息性状态码）**：请求已接收，继续处理，如100 Continue，表示服务器收到请求的头部，客户端应该继续发送请求的主体部分。
- **2xx（成功状态码）**：请求已成功被服务器接收、理解和处理，如200 OK，表示请求成功，服务器成功处理了请求；201 Created表示请求成功，并且服务器创建了新的资源。
- **3xx（重定向状态码）**：需要进一步的操作以完成请求，如301 Moved Permanently表示永久重定向，302 Found表示临时重定向。
- **4xx（客户端错误状态码）**：请求包含语法错误或无法完成请求，如400 Bad Request表示客户端请求有语法错误；401 Unauthorized表示未授权，客户端需要进行身份验证；404 Not Found表示请求的资源在服务器上未找到。
- **5xx（服务器错误状态码）**：服务器在处理请求的过程中发生了错误，如500 Internal Server Error表示服务器内部错误；503 Service Unavailable表示服务器暂时无法处理请求，可能是服务器过载或正在维护等原因。
